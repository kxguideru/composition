<h3>Подготовка ударных <small>(Fabla)</small></h3>

<h4>Обзор</h4>

<p>В сети можно найти немало источников для скачивания бесплатных семплов. По качеству они обычно не хуже коммерческих и часто публикуются для демонстрации больших библиотек. Для того, чтобы с чего-то начать, в попробуем использовать <a href="http://trisamples.com/tri-samples-the-sample-set-vol-1/">Tri Sample Set</a>, состоящий из пяти частей (внизу ссылка на Next Post ведёт к следующему тому).</p>

<p>Выбор для создания партии ударных в KXStudio не очень обширен.</p>

<ol>
    <li><strong>Hydrogen</strong>. Старая добрая драм-машина для Linux в виде отдельной программы. Предоставляет неплохие возможности по обработке семплов, поддерживает многослойные инструменты. Может выводить каждый барабан в отдельном канале JACK. Использование Hydrogen затруднено из-за привязки к встроенному секвенсору. Есть LV2-плагин DrMr Sampler, способный загружать драмкиты Hydrogen и играть их по MIDI, но в нём самом редактировать драмкиты не получится.</li>
    <li><strong>DrumGizmo</strong>. Внушительный плагин для симуляции живых ударников с библиотеками размером от гигабайта и больше. Несмотря на простоту и мощь, не очень подходит для электронной музыки.
    <li><strong>DrumSynth</strong>. Синтезатор (не семплер) звуков ударных, который, быть может, хорош для дополнительных дорожек ударных, но не для основной.</li>
    <li><strong>drumkv1</strong>. Драм-семплер с возможностями по обработке семпла лучше, чем в Hydrogen - с фильтром, LFO, несколькими огибающими и т.п. Для электронной музыки плагин почти идеальный. Из недостатков можно назвать отсутствие поддержки многослойных инструментов, а также только один стерео-выход. К сожалению, пока ещё (октябрь 2015) в стадии бета и нестабилен - например, теряет семплы при загрузке сохранённой сессии.</li>
    <li><strong>Fabla</strong>. Семплер такого же рода как и drumkv1, но попроще. Файлы загружаются на площадку 4x4. Для каждой ячейки можно регулировать и высоту, панораму и огибающую, а на общем выходе можно включить встроенный компрессор.</li>
    <li><strong>FluidSynth</strong>. Можно использовать готовые SoundFont (SF2 - да, в мире Linux об этом формате ещё помнят), создавать свои в редакторе Swami. Но после правки файла и загрузки в синтезатор изменять семплы и их параметры нельзя.</li>
</ol>

<p>Остановимся на варианте Fabla, как наиболее простом и надёжном.</p>

<h4>Группы ударных</h4>

<p>Лучше использовать сразу несколько экземпляров семплера: для бочек, снейров, хай-хэтов и больших тарелок. Получим четыре стерео-канала ударных, на которые можно раздельно навешивать плагины обработки. Выход с них потом отправится на шину <em>Ударные</em> для общей обработки, например, компрессором.</p>

<p>Итак, добавляем четыре MIDI-дорожки с инструментом Fabla, попутно создав для них пустую группу <em>Ударные</em>. Переименуем дорожки, как показано на втором рисунке.</p>
<img src="images/ardour-create-drums.png" />
<img src="images/ardour-drums.png" />

<p>Подключим их звуковые выходы к шине <em>Ударные</em> в окне микшера. Правым щелчком на кнопке входов шины вызываем <strong>Матрицу маршрутизации</strong> и делаем нужные соединения на табе <strong>Дорожки Ardour</strong>.</p>
<img src="images/ardour-drums-strip-in.png" />
<img src="images/ardour-drums-route.png" />

<p>В диалоге выбора файлов Fabla, к сожалению, нельзя прослушивать звук добавляемых семплов. Зато в Ardour есть полезный диалог выбора аудио-файлов с предварительным прослушиванием по наведению. Вызывается он по Ctrl+I. Подходящий файл можно запомнить и загрузить потом в драм-семплер.</p>

<p>По <a href="presets/samples-start.zip">этой ссылке</a> лежит архив с упоминаемыми дальше файлы. Архив распаковать в папку семплов проекта <code>/home/%username%/Audio/Composition/Main/Samples</code>, откуда потом добавлять их в Fabla.</p>

<p>Чтобы открыть интерфейс Fabla, нужно дважды кликнуть на его названии в линейке микшера. Линейка доступна не только в окне микшера, но и в редакторе - слева при выборе любой дорожки. Выберем <em>Бочки</em> и откроем интерфейс Fabla.</p>
<img src="images/ardour-fabla-kick.png" />
<img src="images/ardour-fabla-snare.png" />
<img src="images/ardour-fabla-hihat.png" />
<img src="images/ardour-fabla-cymbal.png" />

<p>Загрузим две бочки, как указано в таблице. Семпл загружается правым щелчком по его ячейке. Номера ячеек считаются слева направо снизу вверх.</p>
<div class="table-responsive">
    <table class="table">
        <thead>
        <tr>
            <th class="drums text-right">Позиция</th>
            <th>Имя файла</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td class="text-right">1</td>
            <td>Kick 006 - Little Room</td>
        </tr>
        <tr>
            <td class="text-right">2</td>
            <td>Kick 008 - Lunar</td>
        </tr>
        </tbody>
    </table>
</div>

<p>Для дорожки <em>Снейры</em> загрузим следующие семплы на вторую строчку снизу:</p>
<div class="table-responsive">
    <table class="table">
        <thead>
        <tr>
            <th class="drums text-right">Позиция</th>
            <th>Имя файла</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td class="text-right">5</td>
            <td>Snare 010 - Notched Combo</td>
        </tr>
        <tr>
            <td class="text-right">6</td>
            <td>Snare 026 - Cloud - TRI</td>
        </tr>
        <tr>
            <td class="text-right">7</td>
            <td>Clap 005 - Elements</td>
        </tr>
        <tr>
            <td class="text-right">8</td>
            <td>Snare 022 - Crunkier</td>
        </tr>
        </tbody>
    </table>
</div>

<p>Звуки для дорожки <em>Хай-хэты</em>, загружаем на третью снизу строчку:</p>
<div class="table-responsive">
    <table class="table">
        <thead>
        <tr>
            <th class="drums text-right">Позиция</th>
            <th>Имя файла</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td class="text-right">9</td>
            <td>Hihat 003 - Traditional Chop</td>
        </tr>
        <tr>
            <td class="text-right">10</td>
            <td>HiHat 004 - Roomy Pedal</td>
        </tr>
        <tr>
            <td class="text-right">11</td>
            <td>HiHat Open 0015 - Deadweight</td>
        </tr>
        </tbody>
    </table>
</div>

<p>Наконец, семплы для дорожки <em>Тарелки</em>, загружаем на верхнюю строчку:</p>
<div class="table-responsive">
    <table class="table">
        <thead>
        <tr>
            <th class="drums text-right">Позиция</th>
            <th>Имя файла</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td class="text-right">13</td>
            <td>Crash 002 - Milo</td>
        </tr>
        <tr>
            <td class="text-right">14</td>
            <td>Ride 001 - Like That</td>
        </tr>
        <tr>
            <td class="text-right">15</td>
            <td>Crash 002 - Mindenergy</td>
        </tr>
        <tr>
            <td class="text-right">16</td>
            <td>Ride 002 - Lil Baby</td>
        </tr>
        </tbody>
    </table>
</div>

<p>Начальный драмкит готов.</p>

<h4>Общий MIDI-трек и фильтр каналов</h4>

<p>Сейчас экземпляры Fabla принимают события по всем MIDI-каналам. Исправим это и ограничимся только 10-ым, который традиционно используется для ударных. Создадим дополнительную дорожку <em>Ударные MIDI</em>. Она будет принимать MIDI-данные, обрабатывать их и рассылать по каналам с Fabla. В поле <strong>Инструмент</strong> указываем <em>-нет-</em>.</p>
<img src="images/ardour-drums-midi.png" />

<p>Выделим новую дорожку в редакторе. В линейке микшера правым щелчком мыши вызовем матрицу маршрутизации на кнопке выходов (внизу над кнопкой <strong>Комментарии</strong>). Если выход не виден в таблице, нужно увеличить ширину диалогового окна. Соединяемся с входами дорожек Fabla. К собственному входу дорожку подключать, конечно же, не нужно.</p>
<img src="images/ardour-drums-midi-route.png" />

<p>Для фильтрации используем MIDI-плагин mda MIDI Channel Filter.</p>

<ol>
    <li>Наводим курсор на верхнюю половину ячейки <em>Фейдер</em>, чтобы новый плагин вставился перед ним.</li>
    <li>Нажимаем правую кнопку мыши и идём по меню: <strong>Добавить плагин/По категории/Filter/MIDI Channel Filter</strong>.</li>
    <li>Двойным щелчком по названию открываем интерфейс добавленного плагина.</li>
    <li>Отключаем все каналы, помимо десятого.</li>
</ol>
<img src="images/ardour-insert-channel-filter.png" />
<img src="images/ardour-channel-filter.png" />

<p>В комнате Claudia <em>Пульт</em> подключим MIDI-вход к новой дорожке и проверим клавиатурой, всё ли правильно играет по десятому каналу.</p>
<img src="images/claudia-ardour-midi-connect.png" />

<p>Каналы ударных в окне редактора нам не пригодятся, их можно скрыть, как мы это прежде сделали с шинами групп. Осталось в окне микшера закрепить мониторинг входа на дорожках ударных (нажать кнопки <em>Вход</em>). Без этого при включении воспроизведения каждый из экземпляров Fabla будет пытаться воспроизвести MIDI только со своей дорожки, игнорируя <em>Ударные MIDI</em>.</p>
<img src="images/ardour-hide-drum-channels.png" />
<img src="images/ardour-drums-input.png" />
