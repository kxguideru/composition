<h3>Создание студии <small>(Claudia, Ardour, MusE)</small></h3>

<h4>Claudia</h4>

<p>Будет использоваться менеджер Claudia, который позволяет объединять несколько программ в сохраняемых проектах. Claudia можно запустить из вкладки Tools в Cadence (окно Cadence после этого можно закрыть). Большая часть работы ляжет на DAW Ardour, но помимо него будут использоваться и некоторые другие программы, которые, как и связи между ними, желательно запоминать для последующих запусков.</p>
<img src="images/claudia-music-studio.png" />

<p>Итак, откроем Claudia и создадим новую студию под названием <em>Музыка</em>. Добавим две комнаты: основную с названием <em>Пульт</em> и дополнительную с названием <em>Эксперименты</em>, для обеих используем шаблон <strong>Basic</strong>. В первой будет развиваться чистовой проект, а во второй можно будет создавать звуковые эффекты, паттерны и прочее - с последующей записью результата в DAW основной комнаты. Запустим студию. Перезапустить мост ALSA MIDI можно из меню Tools.</p>

<p>Теперь комнаты надо соединить. На следующем рисунке виден принцип подключения входов-выходов нашей студии:</p>
<img src="images/claudia-routes.png" />
<ul>
    <li>рабочий звуковой выход основной комнаты подключен к выходу звуковой карты (<strong>Left</strong> к <strong>playback_1</strong>, <strong>Right</strong> к <strong>playback_2</strong>);</li>
    <li>рабочий звуковой выход дополнительной комнаты подключен к входам основной комнаты, чтобы звуковые результаты экспериментов записывать на дорожки DAW;</li>
    <li>мониторные аудио-выходы обеих комнат подключены к выходу звуковой карты;</li>
    <li>выход аппаратного MIDI-контроллера <strong>USB2.0-MIDI</strong> подключен к MIDI-входам комнат (если у вас нет MIDI-клавиатуры, можно использовать виртуальную - JACK Keyboard или vmpk);</li>
    <li>MIDI-выход из основной комнаты направлен в дополнительную, а из дополнительной - в основную.</li>
</ul>

<p>Сохраним созданную студию. Впоследствии можно добавлять или удалять комнаты, менять связи между ними, все правки будут сохраняться с сохранением студии.</p>

<p>Проекты Claudia хранит в XML-файлах, и их можно загружать в комнаты студии. В файловом менеджере создадим папки для файлов композиции. Пусть корневой папкой, в которой хранятся все наши данные будет путь <code>Audio/Composition</code> относительно домашней директории. Для каждого проекта потребуется отдельная дочерняя папка, создадим две: <code>Main</code> и <code>Experiments</code>.</p>

<p class="bs-callout bs-callout-warning">Все пути файлов лучше писать латиницей и без пробелов.</p>

<p>Перейдём в основную комнату, выбрав <strong>Пульт</strong> из списка слева. Создадим новый проект для этой комнаты (Project/New Project). Укажем полный путь к папке проекта (<code>/home/%username%/Audio/Composition/Main</code>), название - Основной проект. Его можно периодически сохранять (Ctrl+S) - после добавления новых программ или изменения соединений.</p>

<h4>Ardour</h4>

<p>Наконец, запустим несколько программ. За основу нашей студии возьмём DAW Ardour версии 4. Для запуска Ardour в проекте:</p>
<img src="images/claudia-ardour.png" />

<ol>
    <li>Нажимаем F2 и вводим команду <code>ardour4 Composition</code> ("Composition" - это имя сессии Ardour, которая будет сохранена в отдельной поддиректории проекта).</li>
    <li>Вводим название <code>Ardour</code>, выбираем <code>Level 0</code>. Другие уровни в Ardour не работают, а нулевой означает, что сессии в самом Ardour придётся сохранять вручную. Некоторые программы, поддерживающие уровень 1 и выше, будут автоматически сохранять свои настройки при сохранении проекта в Claudia.</li>
</ol>

<p>При первом запуске Ardour сообщит, что такой сессии ещё не существует, поэтому нужно её создать:</p>
<img src="images/ardour-new-session.png" />

<ol>
    <li>Нажать на большую кнопку <strong>Создать сессию</strong> в появившемся окне настройки сессии.</li>
    <li>Удалить и заново написать слово "Composition" в поле имени сессии.</li>
    <li>В дополнительных параметрах нужно отключить автоматическое подключение к выходам и шинам, мы будем это делать вручную.</li>
    <li>Сессия будет создана нажатием кнопки Открыть</li>
    <li>Дождаться загрузки DAW, которая происходит довольно долго.</li>
</ol>

<p>Вернёмся в Claudia и в окне комнаты <em>Пульт</em> подключим Ardour, как на рисунке:</p>
<img src="images/claudia-ardour-routes.png" />

<ul>
    <li>выходы от шины Мастер направлены на основной левый и правый выход комнаты;</li>
    <li>выходы audiotiner и Click направлены на мониторный выход комнаты;</li>
</ul>

<h4>MusE</h4>

<p>Функции редактирования MIDI хоть и присутствуют в Ardour, но довольно неудобны, особенно при введении нот мышкой. К счастью, для Linux существует классический и хорошо известный секвенсор MusE, который можно использовать при записи MIDI-партий. С другой стороны, в MusE есть возможности DAW, но они менее продвинутые, чем в Ardour. Поэтому связка MusE+Ardour выглядит оптимальной. Попробуем использовать MusE, как вспомогательный инструмент в экспериментальной комнате, а его выход MIDI записывать на дорожки Ardour.</p>

<p>Итак, выберем комнату <em>Эксперименты</em> в Claudia, создадим "Дополнительный проект" c путём <code>/home/%username%/Audio/Composition/Experiments</code>. Нажав F2, добавим приложение MusE, команда <code>muse Composition</code>. И снова, Composition здесь означает имя файла секвенсора (сохранится как Composition.med). Вообще, теоретически, MusE должен поддерживать Level 2 (LASH), но, похоже, версия в KXStudio собрана без этой поддержки, так что выбираем безопасный уровень 0.</p>
<img src="images/claudia-muse.png" />

<p>Дождавшись загрузки приложения, создадим в MusE два порта JACK MIDI, один для входа, другой для выхода. В меню выбираем Настройки/MIDI-порты/Прогр. синтезаторы. Затем в появившемся диалоговом окне:</p>

<ol>
    <li>Для порта номер 1 нажимаем на стрелку вниз в столбце Имя устройства (рядом с &lt;ничего&gt;). Появится пункт меню, предлагающий создать JACK-устройство, используем его.</li>
    <li>Переименовываем jack-midi-0 в jack-out и отключаем вход (метка в столбце Вх).</li>
    <li>Для порта номер 2 создаём ещё одно JACK-устройство.</li>
    <li>Переименовываем в jack-in и отключаем выход (метка в столбце Вых).</li>
    <li>Сохраняем настройки, нажав OK.</li>
</ol>
<img src="images/muse-midi-create.png" />
<img src="images/muse-midi-create-complete.png" />

<p>При записи с клавиатуры потребуется метроном. Чтобы он заработал, нужен аудио-выход, который создается правым щелчком мыши в свободной области заголовков треков компоновщика. В контекстном меню выбираем пункт <strong>Добавить аудиовыход</strong>. Переименуем эту дорожку в Click двойным щелчком на названии (MusE плохо поддерживает кириллицу, так что придётся использовать латинские названия). Отредактируем параметры метронома, используя меню <strong>Настройки/Метроном</strong>. Там нужно выбрать для него выход Click.</p>
<img src="images/muse-add-output.png" />
<img src="images/muse-metronome.png" />

<p>При необходимости метроном включается кнопкой в конце третьей строки панели инструментов. Осталось только в комнате Claudia <em>Эксперименты</em> подключить вход и выход MIDI, а также аудио-выход к мониторному выходу комнаты, как показано на картинке.</p>
<img src="images/claudia-muse-route.png" />

<p>Сохраним сессию Ardour, файл MusE и проекты в каждой из комнат Claudia.</p>
