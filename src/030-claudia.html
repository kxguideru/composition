<h3>Создание студии <small>(Claudia, Ardour, Rosegarden)</small></h3>

<h4>Claudia</h4>

<p>Будет использоваться менеджер Claudia, который позволяет объединять несколько программ в сохраняемых проектах. Claudia можно запустить из вкладки Tools в Cadence (окно Cadence после этого можно закрыть). Большая часть работы ляжет на DAW Ardour 4, но помимо него будут использоваться и некоторые другие программы, которые, как и связи между ними, желательно запоминать для последующих запусков.</p>
<img src="images/claudia-music-studio.png" />

<p>Итак, откроем Claudia и создадим новую студию под названием <em>Музыка</em>. Добавим две комнаты: основную с названием <em>Пульт</em> и дополнительную с названием <em>Эксперименты</em>, для обеих используем шаблон <strong>Basic</strong>. В первой будет развиваться чистовой проект, а во второй можно создавать звуковые эффекты, паттерны и прочее - с последующей записью результата в DAW основной комнаты. Запустим студию. Перезапустить мост ALSA MIDI можно из меню Tools.</p>

<p>Теперь комнаты надо соединить. На следующем рисунке виден принцип подключения входов-выходов студии:</p>
<img src="images/claudia-routes.png" />
<ul>
    <li>рабочий звуковой выход основной комнаты подключен к выходу звуковой карты (<em>Left</em> к <em>playback_1</em>, <em>Right</em> к <em>playback_2</em>);</li>
    <li>рабочий звуковой выход дополнительной комнаты подключен к входам основной комнаты, чтобы звуковые результаты экспериментов записывать на дорожки DAW;</li>
    <li>мониторные аудио-выходы обеих комнат подключены к выходу звуковой карты;</li>
    <li>выход аппаратного MIDI-контроллера USB2.0-MIDI подключен к MIDI-входам комнат (можно использовать виртуальную клавиатуру - JACK Keyboard или vmpk, для неё надо добавить приложение в проекте комнаты);</li>
    <li>MIDI-выход из основной комнаты направлен в дополнительную, а из дополнительной - в основную.</li>
</ul>

<p>Сохраним созданную студию. Впоследствии можно добавлять или удалять комнаты, менять связи между ними, все правки будут запоминаться с сохранением студии.</p>

<p>Проекты Claudia хранит в XML-файлах, и их можно загружать по одному в ту или иную комнату студии. В файловом менеджере создадим папки для файлов композиции. Пусть корневой папкой, в которой хранятся все наши данные будет путь <code>Audio/Composition</code> относительно домашней. Каждмому проекту требуется отдельная дочерняя папка, создадим две: <code>Main</code> и <code>Experiments</code>. Добавим ещё одну для сторонних семплов: <code>Samples</code>. Все пути файлов лучше писать латиницей и без пробелов.</p>
<img src="images/dolphin-structure.png" />

<p>Перейдём в основную комнату, выбрав <strong>Пульт</strong> из списка слева. Создадим новый проект для этой комнаты через меню (<strong>Project/New Project</strong>. В первом поле диалога укажем полный путь к папке проекта (<code>/home/%username%/Audio/Composition/Main</code>), название - <em>Основной проект</em>. Проект можно периодически сохранять (Ctrl+S) - после добавления новых программ или изменения соединений.</p>

<h4>Ardour</h4>

<p>Наконец, запустим несколько программ. За основу нашей студии возьмём DAW Ardour версии 4. Для запуска Ardour в проекте:</p>

<ol>
    <li>Нажимаем F2 и вводим команду <code>ardour4 Composition</code> ("Composition" - это имя сессии Ardour, которая будет сохранена в отдельной поддиректории проекта).</li>
    <li>Вводим название <code>Ardour</code>.</li>
    <li>выбираем <strong>Level 0</strong>. Другие уровни в Ardour не работают, а нулевой означает, что сессии в самом Ardour придётся сохранять вручную. Некоторые программы, поддерживающие уровень 1 и выше, будут автоматически сохранять свои настройки при сохранении проекта в Claudia.</li>
</ol>
<img src="images/claudia-ardour.png" />

<p>При первом запуске Ardour сообщит, что такой сессии ещё не существует, поэтому нужно её создать:</p>
<img src="images/ardour-new-session.png" />

<ol>
    <li>Нажать на большую кнопку <strong>Создать сессию</strong> в появившемся окне настройки сессии.</li>
    <li>Удалить и заново написать слово "Composition" в поле имени сессии.</li>
    <li>В дополнительных параметрах нужно отключить автоматическое подключение к выходам и шинам, мы будем это делать вручную.</li>
    <li>Сессия будет создана нажатием кнопки Открыть</li>
    <li>Дождаться загрузки DAW, которая происходит довольно долго.</li>
</ol>

<p>Вернёмся в Claudia и в окне комнаты <em>Пульт</em> подключим Ardour, как на рисунке:</p>
<img src="images/claudia-ardour-route.png" />

<ul>
    <li>выходы от шины <em>Мастер</em> направлены на основной левый и правый выход комнаты;</li>
    <li>выходы <em>audiotiner</em> и <em>Click</em> направлены на мониторный выход комнаты;</li>
    <li>MIDI-порты пока не трогаем.</li>
</ul>

<h4>Rosegarden</h4>

<p>Функции редактирования MIDI хоть и присутствуют в Ardour, но не очень удобны, особенно при введении нот мышкой. Там нет отдельного окна для матричного редактора (пиано-ролл), и всё приходится редактировать в одной куче в главном окне. Поэтому для редактирования MIDI лучше использовать какой-нибудь другой, внешний редактор. Он будет находиться в экспериментальной комнате, а его выход MIDI мы будем записывать на дорожки Ardour.</p>

<div class="bs-callout bs-callout-info">
    <p>Для Linux существует несколько полноценных секвенсоров (большинство из них с поддержкой функций DAW, конечно, но нас интересует именно секвенсорная часть).</p>
    <ul>
        <li><strong>MusE</strong>. MIDI/Audio-секвенсор для Linux с нелёгкой судьбой, известный ещё с середины 2000-х. В какой-то момент из него был полностью удален редактор партитур и выделен в отдельный проект MuseScore (который жив и поныне). Затем через некоторое время нотный редактор вернули. Использовался вместо Rosegarden в ранних версиях этого руководства.</li>
        <li><strong>Rosegarden</strong>. Неплохой редактор с массой настроек для MIDI-устройств. Система диалогов несколько запутана и старомодна, в духе ранних версий Cubase. Сильный уклон в General MIDI, хотя многие современные функций DAW присутствуют.</li>
        <li><strong>Qtractor</strong>. Один из самых многообещающих проектов DAW с открытыми исходниками. Содержит некоторые спорные и не совсем понятные решения вроде хранения клипов в отдельных MIDI-файлах, которыми пользователю приходится оперировать в главном окне.</li>
        <li><strong>LMMS</strong>. Позиционируется как аналог FruityLoops для Linux, может понравиться тем, кто привык к интерфейсу этой программы.</li>
    </ul>
</div>

<p>Выберем комнату <em>Эксперименты</em> в Claudia, создадим "Дополнительный проект" c путём <code>/home/%username%/Audio/Composition/Experiments</code>. Нажав Shift+F2, на вкладке <strong>DAW</strong> выберем приложение <i>Rosegarden</i>. Rosegarden поддерживает LADISH Level 1, а значит его данные будут сохраняться при сохранении проекта Claudia. Мы не использовали этот диалог для запуска Ardour, потому что нам требовалось указать название сессии. Подключим входы и выходы MIDI. Если они не отображаются, значит нужно запустить мост через меню <strong>Tools/ALSA-MIDI Bridge/Start Bridge</strong>.</p>
<img src="images/claudia-rosegarden.png" />
<img src="images/claudia-rosegarden-route.png" />

<p>Настроим использование транспорта JACK. Это позволит синхронизировать Rosegarden с Ardour.</p>

<ol>
    <li>В окне параметров (<strong>Правка/Параметры</strong>) ставим галочку в поле <strong>Использовать транспорт JACK</strong>.</li>
    <li>Заодно сменим редактор партитуры на <strong>Матричный редактор</strong>, чтобы по двойному щелчку на сегментах открывался пиано-ролл.</li>
    <li>На всякий случай можно отключить всю MIDI-синхронизацию на вкладке <strong>MIDI/MIDI Sync</strong>. Нажимаем OK.</li>
</ol>

<img src="images/rosegarden-piano-roll.png" />
<img src="images/rosegarden-sync.png" />

<p>Чтобы Ardour не получал MIDI-ноты дважды, обязательно нужно отключить MIDI Thru, убрав галочку с меню <strong>Студия/Сквозная маршрутизация MIDI</strong>.</p>

<p>Сохраним сессию в Ardour и проекты в каждой из комнат Claudia.</p>
